parameters:
  path: ''
  framework: ''
  frameworkGlobal: true

steps:
- template: build.yml
  parameters:
    framework: ${{ parameters.framework }}
    path: ${{ parameters.path }}

- ${{ if eq(parameters.frameworkGlobal, 'false') }}:
  - script: ${{ format('/home/vsts/.dotnet/dotnet test -f {0} --no-build --logger trx -c Release {1}', parameters.framework, parameters.path) }}
    displayName: ${{ format('dotnet test -f {0}', parameters.framework) }}

- ${{ if eq(parameters.frameworkGlobal, 'true') }}:
  - task: DotNetCoreCLI@2
    displayName: ${{ format('dotnet test -c Release -f {0}', parameters.framework) }}
    inputs:
      command: test
      nobuild: true
      projects: ${{ parameters.path }}
      arguments: ${{ format(' -f {0}', parameters.framework) }}
      publishTestResults: true
